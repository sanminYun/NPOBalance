<UserControl x:Class="NPOBalance.Views.EmployeeManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:viewModels="clr-namespace:NPOBalance.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">
    <UserControl.DataContext>
        <viewModels:EmployeeManagementViewModel/>
    </UserControl.DataContext>

    <UserControl.Resources>
        <Style x:Key="EmployeeDataGridRowStyle" TargetType="{x:Type DataGridRow}">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding EmployeeCode, Converter={StaticResource StringIsNotNullOrEmptyConverter}}" Value="True">
                    <Setter Property="Background" Value="#D3D3D3"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#4A90E2"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="7*"/>
        </Grid.ColumnDefinitions>

        <!-- 왼쪽 패널: 사원 목록 -->
        <DockPanel Grid.Column="0" Margin="0,0,5,0">
            <Button DockPanel.Dock="Bottom" 
                    Content="10개 행 추가" 
                    Command="{Binding AddEmployeeCommand}" 
                    Margin="5" 
                    Height="30"/>
            <DataGrid ItemsSource="{Binding Employees}"
                      SelectedItem="{Binding SelectedEmployee, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      SelectionMode="Single"
                      RowStyle="{StaticResource EmployeeDataGridRowStyle}"
                      GridLinesVisibility="All"
                      HorizontalGridLinesBrush="#E0E0E0"
                      VerticalGridLinesBrush="#E0E0E0">
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="{x:Type DataGridColumnHeader}">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="사번" Binding="{Binding EmployeeCode}" Width="*"/>
                    <DataGridTextColumn Header="성명" Binding="{Binding Name}" Width="*"/>
                    <DataGridTextColumn Header="주민(외국인)번호" Binding="{Binding ResidentId}" Width="1.5*"/>
                    <DataGridTextColumn Header="나이" Binding="{Binding Age}" Width="0.5*"/>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>

        <GridSplitter Grid.Column="0" Width="5" HorizontalAlignment="Right" VerticalAlignment="Stretch" Background="LightGray"/>

        <!-- 오른쪽 패널: 사원 상세 정보 -->
        <ScrollViewer Grid.Column="1"
                      VerticalScrollBarVisibility="Auto"
                      IsEnabled="{Binding IsEmployeeSelected}">
            <ScrollViewer.Resources>
                <Style TargetType="{x:Type TextBox}">
                    <Setter Property="VerticalContentAlignment" Value="Center"/>
                </Style>
            </ScrollViewer.Resources>
            <DockPanel LastChildFill="False" Margin="10">

                <!-- 버튼 영역 (맨 아래) -->
                <StackPanel DockPanel.Dock="Bottom"
                            Orientation="Horizontal"
                            Margin="0,20,0,0"
                            HorizontalAlignment="Right">
                    <Button Content="저장" Command="{Binding SaveEmployeeCommand}" Width="100" Height="30" Margin="5"/>
                    <Button Content="삭제" Command="{Binding DeleteEmployeeCommand}" Width="100" Height="30" Margin="5"/>
                </StackPanel>

                <!-- 상세 정보 (위쪽) -->
                <StackPanel DockPanel.Dock="Top"
                            Orientation="Vertical"
                            HorizontalAlignment="Stretch">

                    <!-- 사원번호 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="사원번호" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.EmployeeCode}" Grid.Column="1" Margin="5,0" IsReadOnly="True" HorizontalAlignment="Left" Width="100"/>
                    </Grid>

                    <!-- 성명 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="성명" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Name}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 주민등록번호 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="주민등록번호" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.ResidentId}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 입사일 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="입사일" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <DatePicker SelectedDate="{Binding SelectedEmployee.EmploymentStartDate}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 퇴사일 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="퇴사일" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <DatePicker SelectedDate="{Binding SelectedEmployee.EmploymentEndDate}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 부서 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="부서" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Department}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 직위 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="직위" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Position}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 입사호봉 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="입사호봉" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.StartingSalaryStep}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 부양가족수 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="부양가족수" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Dependents}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="100"/>
                    </Grid>

                    <!-- 예상 총 급여액 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="예상 총 급여액" Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.EstimatedTotalSalary, StringFormat=N0}" Grid.Column="1" Margin="5,0" HorizontalAlignment="Left" Width="200"/>
                    </Grid>

                    <!-- 주소 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="주소" Grid.Column="0" VerticalAlignment="Top" Padding="5,8,5,5" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Address1}" Grid.Column="1" Margin="5,0" MaxLength="100" HorizontalAlignment="Left" Width="500"/>
                    </Grid>

                    <!-- 상세주소 -->
                    <Grid Margin="0,5" HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="상세주소" Grid.Column="0" VerticalAlignment="Top" Padding="5,8,5,5" HorizontalAlignment="Left"/>
                        <TextBox Text="{Binding SelectedEmployee.Address2}" Grid.Column="1" Margin="5,0" MaxLength="100" HorizontalAlignment="Left" Width="500"/>
                    </Grid>

                </StackPanel>

            </DockPanel>
        </ScrollViewer>
    </Grid>
</UserControl>